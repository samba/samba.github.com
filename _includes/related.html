
{% if include.limit > 0 %}
<aside class='related posts'>
<h5 class=''>Related Posts</h5>
<ul class='standard'>
{% assign post_limit_related = include.limit %}
{% for post in site.posts limit:1000 %}
	{% assign include_this_post = false %}
	{% if (post.tags contains 'draft') or (post.published==false) %}{% continue %}{% endif %}
	{% for tag in post.tags limit:30 %}
		{% if page.tags contains tag %}
			{% assign include_this_post = true %}
		{% endif %}
	{% endfor %}
	{% if post.categories == page.categories %}
		{% assign include_this_post = true %}
	{% endif %}
	{% if post.categories contains page.categories or page.categories contains post.categories %}
		{% assign include_this_post = true %}
	{% endif %}
	{% if include_this_post and page.id != post.id %}
	<li data-post-counter='{% decrement post_limit_related %}' class='postlink'>
		<a href='{{ post.url }}'>{{ post.title }}</a>
		<span class='date'>{{ post.date |date:"%d. %b %Y" }}</span>

		{% if include.with_tags %}
		<div class='taglist'>
		<span class='category'>{{post.categories|join:"/"}}</span>
		{% for tag in post.tags limit:10 %}
			<span class='tag'>{{tag}}</span>
		{% endfor %}
		</div>
		{% endif %}
	</li>

	{% endif %}
	{% if post_limit_related == 0 %}{% break %}{% endif %}
{% else %}
	<li><i>No other posts found.</i></li>
{% endfor %}

</ul>
</aside>
{% else %}
	<!-- related posts disabled -->
{% endif %}
