(function(){
/*
 A framework for automating adoption of data attributes for Google Tag Manager, in universal event handlers.
 Copyright Sam Briesemeister, 2016.
 Reference: http://samb.io/pirate.html
*/
(function(m,f,A){function p(a,b){k[a]=b}function t(a,b){for(var c in b)u.call(b,c)&&(a[c]=b[c])}function F(a){return a.substr(5).replace(G,function(a){return a.charAt(0)+a.charAt(2).toUpperCase()})}function n(a,b,c,e,h){var d;d=h?b.removeEventListener||b.detachEvent:b.addEventListener||b.attachEvent;var g=0;a.replace(/(on)?([a-z]+)/g,function(a,h,f){d.call(b,f,c,e);g++})}function H(a,b){var c;a&&a.nodeType?c=[a]:c=f.querySelectorAll(a);return B(c,b)}function B(a,b){var c,e=[];for(c=0;a[c];c++)e[c]=
b.call(a,a[c],c);return e}function I(a,b){for(var c=a.attributes||[],e=c.length;e--;)b.call(a,c[e].name,c[e].value,e,c[e])}function v(a){function b(a,b){J.test(a)&&(a=F(a),u.call(c,a)||(c[a]=b))}for(var c={};a;)I(a,b),a=a.parentNode;return c}function C(a){for(var b=arguments.length;b--;)d.b.muted[arguments[b]]=!0}function w(a){var b=w.cache=w.cache||{};a=a.type.replace("focusin","focus").replace("focusout","blur");var c=(new Date).getTime();if(b[a]>c-("scroll"==a?1E3:10))return!1;b[a]=c;return!0}
function D(a){var b=q.length,c=a.target||a.a;if(w(a))for(;b--;)q[b][0].test(a.type)&&q[b][1].call(c,a)}function E(a,b){return B(f.querySelectorAll(a),b||v)}function x(a,b){!b&&a&&a.call&&(b=a,a=A);q.push([a||K,b])}function y(a,b,c){this.context=a;this.u=b;this.s=c}function L(a){var b;if(a.id||a.name){a:{for(b=a;b=b.parentNode;)if(1===b.nodeType){if(b.matches("label"))break a}else break;b=null}return(b=b||f.querySelector('label[for\x3d"'+(a.id||a.name)+'"]'))&&(b.textContent||b.innerText||b.innerHTML)}return null}
function z(a,b){function c(a,b){a in f?f[a].substr?f[a]=[f[a],b]:f[a].push(b):f[a]=b}for(var e=a.length,h,d,g,f={};e--;)if(d=(h=a[e])&&h.getAttribute("name")){switch(h.tagName.toLowerCase()){case "input":switch(h&&h.getAttribute("type")){case "checkbox":case "radio":h.checked&&c(d,b?L(h)||h.value:h.value);break;default:c(d,h.value)}break;case "select":for(g=h.length;g--;)h[g].selected&&c(d,b?h[g].label:h[g].value);break;default:c(d,h.value)}b&&d in f&&f[d].push&&(f[d]=f[d].join("; "))}return f}function l(a){var b=
l.a=l.a||[];if(a&&a.call)f.body?a.call(f):l.a.push(a);else for(;b.length;)b.pop().call(f)}function M(a){setTimeout(function(){d.f&&(d.h=!1,a.push({pirate:A}),d.h=!0,d.f=!1)},10)}var g={B:!0,c:"{{page.dataLayer.name}}",j:20,i:{D:10,G:20,F:30,A:40,l:50},w:!0,m:{v:"click dblclick tap drag drop scroll mousedown touchstart".split(" "),C:"focus blur focusin focusout copy cut paste select popstate hashchange change input keypress".split(" ")}},d={h:!0,f:!1,g:!1,b:{muted:{}}},k=m.pirate=m.pirate||{},u=Object.hasOwnProperty,
q=[],r=[],J=/^data-/,G=/[a-z]-[a-z]/g,K=/.*/;m[g.c]=m[g.c]||[];p("yellow",function(){g.j=g.i.l});k.gangway=x;k.crew=q;k.ahoy=n;k.pillage=v;k.hornswaggle=E;p("ascertain",function(a){a&&a.call&&r.push(a)});k.config=g;x(/^(focus(in|out)?|blur)$/,function(a){d.g=/^(focus(in)?)$/.test(a.type);d.b.muted.keypress=!d.g;d.b.muted.input=!d.g});C("keypress","input");(function(a){a.a=function(a){var b=a.push,e=this;a.push=function(){e.o.apply(e,arguments);return b.apply(a,arguments)};e.o.apply(e,a)};a.o=function(){for(var a=
arguments.length;a--;)g.j>=g.i.A&&console.info("Attaching event listeners",arguments[a],this.context),n(arguments[a],this.context,this.u,this.s,!1)};a.H=function(){for(var a=arguments.length;a--;)n(arguments[a],this.context,this.u,this.s,!0)}})(y.prototype);(function(a,b,c){var e=a[b];return a[b]=function(){d.h&&c.apply(a,arguments);return e.apply(a,arguments)}})(m[g.c],"push",function(){var a;if(g.j>=g.i.l)for(a=0;a<arguments.length;a++)console.info("DataLayer::push()",arguments[a]);for(a=r.length;a--;)r[a].apply(this,
arguments),M(this)});r.push(function(){for(var a=arguments.length,b,c,e;a--;)u.call(arguments[a],"gtm.element")&&(d.f=!0,e=arguments[a]["gtm.element"],b=v(e),c=arguments[a].pirate=arguments[a].pirate||{},t(c,b),/^form$/i.test(e.tagName)&&t(c,z(e,g.w)),t(arguments[a],{"gtm.elementId":e&&e.id,"gtm.elementClasses":e.className}))});p("swipe",function(a,b){return a.nodeType?z(a,b):H(a,function(a){return z(a,b)})});p("attach",function(a,b,c,e){b=f.querySelectorAll(b);for(var d=b.length;d--;)n(a,b[d],c,
e)});k.ondeck=l;p("moor",function(a){a=E(a);for(var b=a.length;b--;)m[g.c].push(a[b])});k.mute=C;n("load",f,l);n("DOMContentLoaded",f,l);n("readystatechange",f,function(){"interactive"==f.readyState&&l()});f&&f.body&&l(null);x(null,function(a){d.b.muted[a.type]||(d.f=!0,m[g.c].push({event:"pirate."+a.type,"gtm.element":this,pirate:{sourceEvent:a}}))});l(function(){if(g.B){var a;a=new y(f.body,D,!1);a.a(g.m.v);d.b.body=a;a=new y(m,D,!1);a.a(g.m.C);d.b.window=a}})})(window,document,void 0);
}).call(this)