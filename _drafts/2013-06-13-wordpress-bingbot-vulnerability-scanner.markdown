---
title: WordPress Vulnerability Scanner masquerading as BingBot
date: 2013-03-06 10:59:00
layout: post
tags: wordpress administration security
categories: wordpress security
---

I'm reasonably convinced that there's a WordPress vulnerability scanner masquerading as Bing's crawler, "bingbot". It causes me some degree of indigestion, as it periodically taxes some of the web servers I maintain with never-ending failed login attempts, and I get loads of warnings in my email (on my phone).

Notably:

- The loop involves HTTP POSTing to `/wp-login.php`
- The client uses HTTP User-Agent `Mozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)`
- The client also provides cookies, appearing to be a typical user: `PHPSESSID=97e550efa0bf0750469d3a2b7a1dcfba; wordpress_test_cookie=WP+Cookie+check;`

To my knowledge Bing's actual crawler doesn't POST forms or use cookies. Thus, I suspect this client is attempting a dictionary or brute-force password guessing process on the WP login. (I'd be very interested to hear about it, if I'm wrong.)

At the moment, the scan appears to originate from two IPs: 

- 198.154.109.166
- 64.157.4.152

One thing's for sure, either way, Bing doesn't need to log into my WordPress sites.

So first, if possible, blocking those IPs using iptables or similar is ideal:

```shell
for IP_ADDR in "198.154.109.166 64.157.4.152"; do
  iptables -A INPUT -s ${IP_ADDR} -p tcp --destination-port 80 -j DROP
done
```

Assuming these guys might start using other IPs in the future, I'll also forbid access to the login URLs.

```
## /var/www/site/.htaccess
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteCond %{REQUEST_METHOD} ^(post) [NC]
RewriteCond %{HTTP_USER_AGENT} bingbot/.* [NC]
RewriteRule (.*) - [L,F]
</IfModule>

## /var/www/site/wp-admin/.htaccess
<IfModule mod_rewrite.c>
RewriteEngine on
RewriteCond %{HTTP_USER_AGENT} bingbot/.* [NC]
RewriteRule (.*) - [L,F]
</IfModule>
```

And that's pretty much it.

Good luck!

See also:
- [Eight Ways to Blacklist with Apache's mod_rewrite](http://perishablepress.com/eight-ways-to-blacklist-with-apaches-mod_rewrite/)
